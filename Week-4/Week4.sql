-- creating department table
CREATE TABLE DEPARTMENT(DNAME VARCHAR(30) UNIQUE,DNUMBER INT UNIQUE,MGR_SSN INT,MGR_START_DATE DATE NOT NULL,PRIMARY KEY(DNUMBER));
-- creating employee table
CREATE TABLE EMPLOYEE(FNAME VARCHAR(30) NOT NULL,MINIT VARCHAR(1),LNAME VARCHAR(30) NOT NULL,SSN INT NOT NULL,BDATE DATE NOT NULL CHECK(BDATE<'1985-01-01'),
ADDRESS VARCHAR(100) NOT NULL,SEX VARCHAR(1) NOT NULL,SALARY INT NOT NULL,PRIMARY KEY(SSN),SUPER_SSN INT,
FOREIGN KEY(SUPER_SSN) REFERENCES EMPLOYEE(SSN),DNO INT,FOREIGN KEY(DNO) REFERENCES DEPARTMENT(DNUMBER));
-- adding constraint
ALTER TABLE DEPARTMENT ADD CONSTRAINT FK_MANAGER_EMP FOREIGN KEY(MGR_SSN) REFERENCES EMPLOYEE(SSN);
-- creating dept_locations table
CREATE TABLE DEPT_LOCATIONS(DNUMBER INT NOT NULL,DLOCATION VARCHAR(50) NOT NULL,PRIMARY KEY(DNUMBER,DLOCATION),
FOREIGN KEY(DNUMBER) REFERENCES DEPARTMENT(DNUMBER));
-- creating project table
CREATE TABLE PROJECT(PNAME VARCHAR(20) DEFAULT 'Project',PNUMBER INT NOT NULL,PLOCATION VARCHAR(100) NOT NULL,DNUM INT NOT NULL,
PRIMARY KEY(PNUMBER));
-- creating works_on table
CREATE TABLE WORKS_ON(ESSN INT NOT NULL,PNO INT NOT NULL,HOURS INT NOT NULL,PRIMARY KEY(ESSN,PNO),FOREIGN KEY(ESSN) REFERENCES EMPLOYEE(SSN),
FOREIGN KEY(PNO) REFERENCES PROJECT(PNUMBER));
-- creating dependent table
CREATE TABLE DEPENDENT(ESSN INT NOT NULL,DEPENDENT_NAME VARCHAR(30) NOT NULL,SEX VARCHAR(1) NOT NULL,BDATE DATE NOT NULL,
RELATIONSHIP VARCHAR(30) NOT NULL DEFAULT 'Parent',PRIMARY KEY(ESSN,DEPENDENT_NAME),FOREIGN KEY(ESSN) REFERENCES EMPLOYEE(SSN));


INSERT INTO DEPARTMENT(DNAME,DNUMBER,MGR_SSN,MGR_START_DATE) VALUES('RESEARCH',5,NULL,'1988-05-22');
INSERT INTO DEPARTMENT(DNAME,DNUMBER,MGR_SSN,MGR_START_DATE) VALUES('ADMINISTRATION',4,NULL,'1995-01-01');
INSERT INTO DEPARTMENT(DNAME,DNUMBER,MGR_SSN,MGR_START_DATE) VALUES('HEADQUARTERS',1,NULL,'1981-06-19');

INSERT INTO EMPLOYEE(FNAME,MINIT,LNAME,SSN,BDATE,ADDRESS,SEX,SALARY,SUPER_SSN,DNO) VALUES('JAMES','E','BORG',888665555,'1937-11-10','405 STONE,HOUSTON,TX','M',55000,NULL,1);
INSERT INTO EMPLOYEE(FNAME,MINIT,LNAME,SSN,BDATE,ADDRESS,SEX,SALARY,SUPER_SSN,DNO) VALUES('FRANKLIN','T','WONG',333445555,'1955-12-08','638 VOSS,HOUSTON,TX','M',40000,888665555,5);
INSERT INTO EMPLOYEE(FNAME,MINIT,LNAME,SSN,BDATE,ADDRESS,SEX,SALARY,SUPER_SSN,DNO) VALUES('JOHN','B','SMITH',123456789,'1965-01-09','731 FONDREN,HOUSTON,TX','M',30000,333445555,5);
INSERT INTO EMPLOYEE(FNAME,MINIT,LNAME,SSN,BDATE,ADDRESS,SEX,SALARY,SUPER_SSN,DNO) VALUES('JENNIFER','S','WALLACE',987654321,'1941-06-20','291 BERRY,BELLAIRE,TX','F',43000,888665555,4);
INSERT INTO EMPLOYEE(FNAME,MINIT,LNAME,SSN,BDATE,ADDRESS,SEX,SALARY,SUPER_SSN,DNO) VALUES('ALICIA','J','ZELAYA',999887777,'1968-01-19','3321 CASTLE,SPRING,TX','F',25000,987654321,4);
INSERT INTO EMPLOYEE(FNAME,MINIT,LNAME,SSN,BDATE,ADDRESS,SEX,SALARY,SUPER_SSN,DNO) VALUES('RAMESH','K','NARAYAN',666884444,'1962-09-15','975 FIRE OAK,HOUSTON,TX','M',38000,333445555,5);
INSERT INTO EMPLOYEE(FNAME,MINIT,LNAME,SSN,BDATE,ADDRESS,SEX,SALARY,SUPER_SSN,DNO) VALUES('JOYCE','A','ENGLISH',453453453,'1972-07-31','5631 RICE,HOUSTON,TX','F',25000,333445555,5);
INSERT INTO EMPLOYEE(FNAME,MINIT,LNAME,SSN,BDATE,ADDRESS,SEX,SALARY,SUPER_SSN,DNO) VALUES('AHMAD','V','JABBAR',987987987,'1969-03-29','975 FIRE OAK,HOUSTON,TX','M',25000,987654321,4);

UPDATE DEPARTMENT SET MGR_SSN=333445555 WHERE DNUMBER=5;
UPDATE DEPARTMENT SET MGR_SSN=987654321 WHERE DNUMBER=4;
UPDATE DEPARTMENT SET MGR_SSN=888665555 WHERE DNUMBER=1;

INSERT INTO DEPT_LOCATIONS(DNUMBER,DLOCATION) VALUES (1,'HOUSTON'),(4,'STAFFORD'),(5,'BELLAIRE'),(5,'SUGARLAND'),(5,'HOUSTON');

INSERT INTO PROJECT(PNAME,PNUMBER,PLOCATION,DNUM) VALUES('PRODUCTX',1,'BELLAIRE',5),('PRODUCTY',2,'SUGARLAND',5),('PRODUCTZ',3,'HOUSTON',5),('COMPUTERIZATION',10,'STAFFORD',4),('REORGANIZATION',20,'HOUSTON',1),('NEWBENEFITS',30,'STAFFORD',4);

INSERT INTO WORKS_ON(ESSN,PNO,HOURS) VALUES (123456789,1,32.5),(123456789,2,7.5),(666884444,3,40.0),(453453453,1,20.0),(453453453,2,20.0),(333445555,2,10.0),(333445555,3,10.0),(333445555,10,10.0),(333445555,20,10.0),(999887777,30,30.0),(999887777,10,10.0),(987987987,10,35.0),(987987987,30,5.0),(987654321,30,20.0),(987654321,20,15.0);
INSERT INTO WORKS_ON(ESSN,PNO,HOURS) VALUES (888665555,20,NULL);

INSERT INTO DEPENDENT(ESSN,DEPENDENT_NAME,SEX,BDATE,RELATIONSHIP) VALUES(333445555,'ALICE','F','1986-04-05','DAUGHTER'),(333445555,'THEODORE','M','1983-10-25','SON'),(333445555,'JOY','F','1958-05-03','SPOUSE'),(987654321,'ABNER','M','1942-02-28','SPOUSE'),(123456789,'MICHAEL','M','1988-01-04','SON'),(123456789,'ALICE','F','1988-12-30','DAUGHTER'),(123456789,'ELIZABETH','F','1967-05-05','SPOUSE');
